generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                        String    @id @default(uuid())
  name                      String
  phoneNumber               String
  email                     String?   @unique
  addresses                 Address[]
  orders                    Orders[]
  createdAt                 DateTime  @default(now())
  updatedAt                 DateTime  @updatedAt
}

model Address {
  id String @id @default(uuid())

  houseNumber String
  floor       String?
  area        String
  landmark    String?
  pincode     String?
  cityName    String?

  // we will get through Gio location api
  latitude  Float?
  longitude Float?

  // üè∑Ô∏è Type
  type AddressType // home, work, hotel, other

  // üë§ Relationship
  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)
  orders  Orders[]
  // üïì Metadata
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
  @@index([latitude, longitude])
}

enum AddressType {
  home
  work
  hotel
  other
}

model Product {
  id                        String   @id @default(uuid())
  productTitle              String
  description               String
  price                     Int
  category                  ProductCategory
  media                     Media[]
  orders                    Orders[]
  createdAt                 DateTime @default(now())
  updatedAt                 DateTime @updatedAt
}

enum ProductCategory {
  Dairy
  Bread
  Eggs
  Snacks
  Munchies
}

model Media {
  id                        String    @id @default(uuid())
  url                       String
  mediaType                 MediaType
  prodcutId                 String
  user                      Product   @relation(fields: [prodcutId], references: [id])
  createdAt                 DateTime  @default(now())
  updatedAt                 DateTime  @updatedAt
}

enum MediaType {
  image
  video
}


model Orders {
  id                        String        @id @default(uuid())
  productId                 String    
  userId                    String    
  adressId                  String    
  address                   Address       @relation(fields: [adressId], references: [id])
  product                   Product       @relation(fields: [productId], references: [id])
  user                      User          @relation(fields: [userId], references: [id])
  createdAt                 DateTime      @default(now())
  updatedAt                 DateTime      @updatedAt
}